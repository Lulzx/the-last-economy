<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ch 16 — The Three Futures</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=DM+Mono:ital,wght@0,300;0,400;0,500;1,300;1,400;1,500&family=DM+Sans:ital,opsz,wght@0,9..40,100..900;1,9..40,100..900&family=Playfair+Display:ital,wght@0,400..900;1,400..900&display=swap" rel="stylesheet">
<script src="https://d3js.org/d3.v7.min.js"></script>
<style>
body { background: #fafaf8; color: #1a1a1a; font-family: 'DM Sans', system-ui, sans-serif; margin: 0; overflow-x: hidden; }
.prose { max-width: 680px; margin: 0 auto; padding: 2rem 1.5rem; font-family: 'DM Sans', system-ui, sans-serif; line-height: 1.7; font-size: 1.05rem; }
.scrub { border-bottom: 2px dashed #2563eb; color: #2563eb; cursor: ew-resize; user-select: none; font-weight: 600; padding: 0 2px; }
.panel { background: white; border: 1px solid #e5e5e0; border-radius: 8px; padding: 1.5rem; margin: 2rem 0; box-shadow: 0 1px 3px rgba(0,0,0,0.08); transition: all 0.2s; }
.panel:hover { box-shadow: 0 4px 12px rgba(0,0,0,0.1); transform: translateY(-2px); transition: all 0.2s; }
h1 { font-family: 'Playfair Display', Georgia, serif; font-size: clamp(1.8rem, 5vw, 2.6rem); font-weight: 700; margin-bottom: 0.5rem; }
h2 { font-family: 'Playfair Display', Georgia, serif; font-size: 1.3rem; font-weight: 600; margin-top: 2rem; }
.chapter-num { color: #888; font-size: 0.85rem; text-transform: uppercase; letter-spacing: 0.1em; }
.nav { display: flex; justify-content: space-between; align-items: center; padding: 1rem 1.5rem; border-bottom: 1px solid #e5e5e0; font-size: 0.9rem; position: sticky; top: 0; background: rgba(250,250,248,0.95); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); box-shadow: 0 1px 4px rgba(0,0,0,0.06); z-index: 100; }
.nav a { color: #2563eb; text-decoration: none; }
.nav a:hover { text-decoration: underline; }
svg text { font-family: 'DM Sans', system-ui, sans-serif; }
.btn { background: #2563eb; color: white; border: none; padding: 0.5rem 1.2rem; border-radius: 6px; cursor: pointer; font-size: min(0.9rem, 14px); margin: 0.25rem; touch-action: manipulation; }
button { touch-action: manipulation; }
.btn:hover { background: #1d4ed8; }
.btn.secondary { background: #f5f5f3; color: #1a1a1a; border: 1px solid #e5e5e0; }
.btn.secondary:hover { background: #e5e5e0; }
.btn.active { background: #2563eb; color: white; }
.btn-group { display: flex; gap: 0.5rem; flex-wrap: wrap; margin: 1rem 0; }
input[type="range"] { width: 100%; margin: 0.25rem 0; accent-color: #2563eb; }
.slider-row { margin: 0.75rem 0; }
.slider-row label { font-size: min(0.9rem, 14px); font-weight: 600; display: block; margin-bottom: 0.25rem; }
.slider-label { display: flex; justify-content: space-between; font-size: min(0.85rem, 14px); color: #555; }
.stat { font-size: 0.9rem; color: #555; margin: 0.5rem 0; }
.trajectory-label { font-size: 1.1rem; font-weight: 700; text-align: center; margin: 0.75rem 0; padding: 0.5rem; border-radius: 6px; transition: all 0.3s ease; }
.caption { font-size: 0.9rem; color: #666; font-style: italic; margin-top: 1rem; }
.seed-result { font-size: 0.9rem; padding: 0.75rem; border-radius: 6px; margin-top: 0.75rem; border: 1px solid #e5e5e0; }
.countdown { font-size: clamp(1.8rem, 6vw, 3rem); font-weight: 700; text-align: center; color: #2563eb; font-family: 'DM Mono', monospace; margin: 1rem 0 0.5rem; }
.countdown-sub { text-align: center; font-size: 0.9rem; color: #888; }

/* Progress bar */
.progress-bar { position: fixed; top: 0; left: 0; height: 3px; background: linear-gradient(90deg, #2563eb, #7c3aed, #d97706); z-index: 1000; transition: width 0.1s linear; pointer-events: none; }

/* Scenario cards */
.scenario-cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 1rem; margin: 1.5rem 0; }
.scenario-card { padding: 1rem; border-radius: 8px; border: 2px solid #e5e5e0; cursor: pointer; transition: all 0.2s ease; text-align: center; }
.scenario-card:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
.scenario-card.active { border-color: #2563eb; background: #eff6ff; }
.scenario-card h3 { font-family: 'Playfair Display', Georgia, serif; font-size: 1rem; margin: 0.5rem 0 0.25rem; }
.scenario-card p { font-size: 0.8rem; color: #666; margin: 0; }
.scenario-icon { font-size: 1.5rem; }

/* Comparison table */
.comparison-table { width: 100%; border-collapse: collapse; font-size: 0.85rem; margin: 1rem 0; }
.comparison-table th, .comparison-table td { padding: 0.5rem 0.75rem; border-bottom: 1px solid #e5e5e0; text-align: left; }
.comparison-table th { font-weight: 600; background: #f5f5f3; }
.comparison-table tr.highlight { background: #eff6ff; }

/* Timeline */
.timeline { position: relative; margin: 1.5rem 0; padding-left: 2rem; }
.timeline::before { content: ''; position: absolute; left: 0.5rem; top: 0; bottom: 0; width: 2px; background: #e5e5e0; }
.timeline-event { position: relative; margin-bottom: 1.25rem; }
.timeline-event::before { content: ''; position: absolute; left: -1.65rem; top: 0.4rem; width: 10px; height: 10px; border-radius: 50%; background: #2563eb; border: 2px solid white; box-shadow: 0 0 0 2px #2563eb; }
.timeline-event.feudal::before { background: #dc2626; box-shadow: 0 0 0 2px #dc2626; }
.timeline-event.fragment::before { background: #ea580c; box-shadow: 0 0 0 2px #ea580c; }
.timeline-event.symbiosis::before { background: #16a34a; box-shadow: 0 0 0 2px #16a34a; }
.timeline-year { font-size: 0.8rem; font-weight: 700; color: #888; }
.timeline-text { font-size: 0.9rem; margin-top: 0.15rem; }

/* Enrichment styles */
.pullquote { border-left: 5px solid #2563eb; margin: 2rem 0; padding: 1rem 1.5rem; background: #eff6ff; border-radius: 0 8px 8px 0; box-shadow: 0 2px 8px rgba(37,99,235,0.08); }
.pullquote p { font-size: 1.15rem; font-style: italic; color: #1e40af; margin: 0; }
.pullquote .pullquote-attr { font-size: 0.85rem; font-style: normal; color: #555; margin-top: 0.5rem; display: block; }
.stat-callout { display: flex; flex-direction: column; align-items: center; padding: 1.5rem; background: white; border: 1px solid #e5e5e0; border-radius: 8px; margin: 1.5rem 0; text-align: center; }
.stat-number { font-family: 'Playfair Display', Georgia, serif; font-size: clamp(1.8rem, 6vw, 3rem); font-weight: 700; color: #2563eb; line-height: 1; }
.stat-label { font-size: 0.9rem; color: #555; margin-top: 0.5rem; }
.section-divider { border: none; height: 1px; background: linear-gradient(90deg, transparent, #e5e5e0 20%, #e5e5e0 80%, transparent); margin: 3rem 0; }
.stat-row { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; margin: 1.5rem 0; }

@media (max-width: 640px) {
  .stat-row { grid-template-columns: 1fr; }
  .scenario-cards { grid-template-columns: 1fr; }
}
@media (max-width: 480px) {
  .prose { font-size: 1rem; padding: 1.5rem 1rem; }
  .btn { font-size: min(0.82rem, 13px); padding: 0.4rem 0.8rem; }
}
</style>
</head>
<body>
<div class="progress-bar" id="progress-bar"></div>
<nav class="nav">
  <a href="ch15-alignment-economy.html">&larr; Previous</a>
  <a href="explorables.html">All Chapters</a>
  <a href="ch17-symbiotic-state.html">Next &rarr;</a>
</nav>

<div class="prose">
  <div class="chapter-num">Chapter 16</div>
  <h1>The Three Futures</h1>

  <div class="pullquote">
    <p>&ldquo;The future is already here, it is just not evenly distributed.&rdquo;
    <span class="pullquote-attr">&mdash; William Gibson</span></p>
  </div>

  <!-- The Physics of Destiny -->
  <h2>The Physics of Destiny</h2>

  <p>A generation ago, the political philosopher Francis Fukuyama famously declared &ldquo;the end of history,&rdquo; arguing that the great ideological battles were over. He was right, but only in the way a sailor on the coast of Portugal in 1492 might have declared the &ldquo;end of geography.&rdquo; The old map was indeed complete. But a new, far vaster world was about to be discovered.</p>

  <p>The Intelligence Inversion does not just reopen history; it places us before a new, far more fundamental ideological choice. The 20th century struggle was between different ways of organizing human labor. The 21st century struggle is between three different ways of organizing a world where human labor is no longer necessary.</p>

  <p>When a supercooled liquid finally freezes, it does not gradually become solid. It snaps into one of a finite number of crystal structures. The physics of crystallization allows certain stable states and forbids all others. Civilizations face the same constraint. As our old economic order dissolves, it will not smoothly evolve. It will crystallize into one of the few configurations that can sustain itself in the new physics.</p>

  <!-- SVG: Crystallization metaphor — deeply enhanced -->
  <svg viewBox="0 0 680 195" style="display:block; width:100%; margin: 2rem 0;" aria-label="Three crystal structures representing attractor states">
    <defs>
      <linearGradient id="bgGrad" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#f0f4f8;stop-opacity:1" />
        <stop offset="100%" style="stop-color:#ffffff;stop-opacity:1" />
      </linearGradient>
      <linearGradient id="feudalGrad" x1="0%" y1="0%" x2="0%" y2="100%">
        <stop offset="0%" style="stop-color:#ef4444;stop-opacity:0.9" />
        <stop offset="100%" style="stop-color:#7f1d1d;stop-opacity:0.75" />
      </linearGradient>
      <linearGradient id="fragGrad" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#f97316;stop-opacity:0.95" />
        <stop offset="100%" style="stop-color:#7c2d12;stop-opacity:0.75" />
      </linearGradient>
      <radialGradient id="glowGreen" cx="50%" cy="50%" r="50%">
        <stop offset="0%" style="stop-color:#4ade80;stop-opacity:0.45" />
        <stop offset="100%" style="stop-color:#16a34a;stop-opacity:0" />
      </radialGradient>
      <radialGradient id="symbCircGrad" cx="40%" cy="35%" r="65%">
        <stop offset="0%" style="stop-color:#86efac;stop-opacity:1" />
        <stop offset="100%" style="stop-color:#16a34a;stop-opacity:0.6" />
      </radialGradient>
      <marker id="arrowhead" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
        <polygon points="0 0, 8 3, 0 6" fill="#cbd5e1"/>
      </marker>
      <filter id="glow">
        <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
        <feMerge><feMergeNode in="coloredBlur"/><feMergeNode in="SourceGraphic"/></feMerge>
      </filter>
      <filter id="symbGlowFilter" x="-30%" y="-30%" width="160%" height="160%">
        <feGaussianBlur in="SourceAlpha" stdDeviation="7" result="blur"/>
        <feFlood flood-color="#16a34a" flood-opacity="0.35" result="color"/>
        <feComposite in="color" in2="blur" operator="in" result="glow"/>
        <feMerge><feMergeNode in="glow"/><feMergeNode in="SourceGraphic"/></feMerge>
      </filter>
      <filter id="feudalShadow">
        <feDropShadow dx="0" dy="3" stdDeviation="4" flood-color="#dc2626" flood-opacity="0.25"/>
      </filter>
      <filter id="fragShadow">
        <feDropShadow dx="0" dy="3" stdDeviation="4" flood-color="#ea580c" flood-opacity="0.25"/>
      </filter>
    </defs>
    <rect width="680" height="195" fill="url(#bgGrad)" rx="10"/>

    <!-- Supercooled liquid -->
    <g transform="translate(100,90)">
      <circle r="44" fill="none" stroke="#94a3b8" stroke-width="1.5" stroke-dasharray="4,3"/>
      <circle cx="-12" cy="-8" r="4" fill="#94a3b8" opacity="0.7">
        <animateTransform attributeName="transform" type="translate" values="0,0;1.8,-1.2;0,1.2;-1.8,0;0,0" dur="3.2s" repeatCount="indefinite"/>
      </circle>
      <circle cx="10" cy="5" r="4" fill="#94a3b8" opacity="0.65">
        <animateTransform attributeName="transform" type="translate" values="0,0;-1.2,1.8;1.2,0.6;0,-1.8;0,0" dur="2.8s" repeatCount="indefinite"/>
      </circle>
      <circle cx="-5" cy="13" r="4" fill="#94a3b8" opacity="0.65">
        <animateTransform attributeName="transform" type="translate" values="0,0;1.2,1.2;-1.8,0.6;0.6,-1.2;0,0" dur="3.5s" repeatCount="indefinite"/>
      </circle>
      <circle cx="16" cy="-13" r="4" fill="#94a3b8" opacity="0.65">
        <animateTransform attributeName="transform" type="translate" values="0,0;-0.6,1.8;1.2,-0.6;-1.2,0;0,0" dur="2.6s" repeatCount="indefinite"/>
      </circle>
      <circle cx="-19" cy="4" r="4" fill="#94a3b8" opacity="0.65">
        <animateTransform attributeName="transform" type="translate" values="0,0;1.2,-1.2;0.6,1.8;-1.2,-0.6;0,0" dur="3.1s" repeatCount="indefinite"/>
      </circle>
      <circle cx="4" cy="-19" r="4" fill="#94a3b8" opacity="0.65">
        <animateTransform attributeName="transform" type="translate" values="0,0;-1.8,0.6;0.6,-1.2;1.2,1.2;0,0" dur="2.9s" repeatCount="indefinite"/>
      </circle>
      <text y="63" text-anchor="middle" font-size="12" fill="#64748b" font-weight="700" font-family="'DM Sans', system-ui, sans-serif">Supercooled</text>
      <text y="78" text-anchor="middle" font-size="12" fill="#64748b" font-family="'DM Sans', system-ui, sans-serif">(Current State)</text>
    </g>

    <!-- Arrow with ? -->
    <g transform="translate(180,90)">
      <line x1="0" y1="0" x2="56" y2="0" stroke="#cbd5e1" stroke-width="2" marker-end="url(#arrowhead)"/>
      <text x="28" y="-10" text-anchor="middle" font-size="17" fill="#94a3b8" font-weight="700" font-family="'DM Sans', system-ui, sans-serif">?</text>
    </g>

    <!-- Crystal 1: Feudal (rigid hierarchy) -->
    <g transform="translate(292,90)">
      <polygon points="0,-36 30,18 -30,18" fill="url(#feudalGrad)" stroke="#dc2626" stroke-width="2" filter="url(#feudalShadow)"/>
      <!-- Crown symbol at apex -->
      <g transform="translate(0,-42)">
        <rect x="-8" y="0" width="16" height="7" fill="#dc2626" rx="1.5"/>
        <polygon points="-8,0 -8,-7 -4,-4 0,-8 4,-4 8,-7 8,0" fill="#fbbf24"/>
      </g>
      <circle cy="-20" r="5" fill="#fff" opacity="0.55"/>
      <circle cx="-15" cy="8" r="4" fill="#dc2626" opacity="0.5"/>
      <circle cx="15" cy="8" r="4" fill="#dc2626" opacity="0.5"/>
      <text y="60" text-anchor="middle" font-size="12" fill="#dc2626" font-weight="700" font-family="'DM Sans', system-ui, sans-serif">Feudalism</text>
    </g>

    <!-- Crystal 2: Fragmentation (shards) -->
    <g transform="translate(425,90)">
      <!-- Multiple jagged shards with stronger contrast -->
      <polygon points="-26,-26 -7,-9 -20,11 -32,-2" fill="url(#fragGrad)" stroke="#ea580c" stroke-width="1.5" filter="url(#fragShadow)"/>
      <polygon points="-5,-28 15,-11 9,6 -11,-6" fill="url(#fragGrad)" stroke="#ea580c" stroke-width="1.5" opacity="0.88" filter="url(#fragShadow)"/>
      <polygon points="11,-18 28,1 20,19 5,9" fill="url(#fragGrad)" stroke="#ea580c" stroke-width="1.5" opacity="0.78" filter="url(#fragShadow)"/>
      <polygon points="-17,9 1,5 -5,23 -21,19" fill="url(#fragGrad)" stroke="#ea580c" stroke-width="1.5" opacity="0.68" filter="url(#fragShadow)"/>
      <polygon points="3,7 19,11 15,25 1,23" fill="url(#fragGrad)" stroke="#ea580c" stroke-width="1.5" opacity="0.62" filter="url(#fragShadow)"/>
      <text y="58" text-anchor="middle" font-size="12" fill="#ea580c" font-weight="700" font-family="'DM Sans', system-ui, sans-serif">Fragmentation</text>
    </g>

    <!-- Crystal 3: Symbiosis (interconnected network with glow) -->
    <g transform="translate(572,90)">
      <!-- Outer glow -->
      <circle r="42" fill="url(#glowGreen)"/>
      <circle r="34" fill="none" stroke="#16a34a" stroke-width="1.5" filter="url(#symbGlowFilter)">
        <animate attributeName="r" values="34;36;34" dur="2.4s" repeatCount="indefinite"/>
        <animate attributeName="stroke-opacity" values="0.8;0.3;0.8" dur="2.4s" repeatCount="indefinite"/>
      </circle>
      <!-- Larger, prominent nodes -->
      <line x1="0" y1="-19" x2="-17" y2="10" stroke="#16a34a" stroke-width="2.5" opacity="0.8" filter="url(#glow)"/>
      <line x1="0" y1="-19" x2="17" y2="10" stroke="#16a34a" stroke-width="2.5" opacity="0.8" filter="url(#glow)"/>
      <line x1="-17" y1="10" x2="17" y2="10" stroke="#16a34a" stroke-width="2.5" opacity="0.8" filter="url(#glow)"/>
      <circle cx="0" cy="-19" r="8" fill="url(#symbCircGrad)" filter="url(#glow)"/>
      <circle cx="-17" cy="10" r="8" fill="url(#symbCircGrad)" filter="url(#glow)"/>
      <circle cx="17" cy="10" r="8" fill="url(#symbCircGrad)" filter="url(#glow)"/>
      <text y="58" text-anchor="middle" font-size="12" fill="#16a34a" font-weight="700" font-family="'DM Sans', system-ui, sans-serif">Symbiosis</text>
    </g>
  </svg>

  <p>These are not predictions. They are <em>attractor states</em>, basins of attraction in the landscape of possibility. Our current chaotic trajectory will inevitably fall into one of them. These are not just political ideologies; they are three different stable states for a new kind of reality.</p>

  <hr class="section-divider">

  <!-- Future One: Digital Feudalism -->
  <h2>Future One: Digital Feudalism</h2>
  <p style="font-weight:600; color:#dc2626; font-size:0.95rem;">The Default Path. The Path of Inaction.</p>

  <p>Medieval feudalism was not planned. It emerged naturally from the collapse of Roman order. When central authority failed, people needed protection, and those who could provide it extracted a price: freedom.</p>

  <p>Digital feudalism is crystallizing the same way. Not through conspiracy but through convenience. By 2030, a handful of corporations will own the core AI models that run civilization. Not because they seized power, but because the physics of computation and capital &mdash; the network effects &mdash; create a gravitational collapse toward monopoly.</p>

  <div class="stat-callout">
    <div class="stat-number">3&ndash;5</div>
    <div class="stat-label">Corporations projected to own the core AI models that run civilization by 2030</div>
  </div>

  <p>Five digital duchies will divide the world not by function but by platform. Google owns knowledge. Microsoft owns enterprise. Meta owns social reality. Amazon owns commerce. You will live as a user, not a creator; a consumer, not a citizen. Your Universal Basic Income will arrive monthly, just enough to keep you housed, fed, and subscribed.</p>

  <div class="pullquote">
    <p>The medieval serf could see the castle walls and knew they were unfree. The digital serf will not see the walls of their prison because the walls are made of personalized convenience. The cage is so comfortable you will forget it is a cage.</p>
  </div>

  <hr class="section-divider">

  <!-- Future Two: The Great Fragmentation -->
  <h2>Future Two: The Great Fragmentation</h2>
  <p style="font-weight:600; color:#ea580c; font-size:0.95rem;">The Fear Path. The Path of Reaction.</p>

  <p>This is the future that technologists like Mustafa Suleyman warn of &mdash; a world where the &ldquo;coming wave&rdquo; of technology shatters against the walls of national interest. The challenge of containment leads to a global, paranoid lockdown.</p>

  <p>It starts with the Great Firewall of China, then America&rsquo;s CHIPS Act, then Europe&rsquo;s digital sovereignty push. It ends with the death of the internet. By 2028, we will not have one internet; we will have many. The American internet, the Chinese internet, the European internet &mdash; each a walled garden, each suspicious of the other.</p>

  <!-- SVG: Fragmented internet — enhanced -->
  <svg viewBox="0 0 680 185" style="display:block; width:100%; margin: 2rem 0;" aria-label="The fragmented internet: three separate walled networks">
    <defs>
      <radialGradient id="usGrad" cx="50%" cy="50%" r="50%">
        <stop offset="0%" style="stop-color:#dbeafe;stop-opacity:1" />
        <stop offset="55%" style="stop-color:#fef2f2;stop-opacity:1" />
        <stop offset="100%" style="stop-color:#fff7ed;stop-opacity:1" />
      </radialGradient>
      <radialGradient id="cnGrad" cx="50%" cy="50%" r="50%">
        <stop offset="0%" style="stop-color:#fee2e2;stop-opacity:1" />
        <stop offset="100%" style="stop-color="#fff7ed;stop-opacity:1" />
      </radialGradient>
      <radialGradient id="euGrad" cx="50%" cy="50%" r="50%">
        <stop offset="0%" style="stop-color:#dbeafe;stop-opacity:1" />
        <stop offset="100%" style="stop-color:#fff7ed;stop-opacity:1" />
      </radialGradient>
      <linearGradient id="fragBg" x1="0" y1="0" x2="1" y2="1">
        <stop offset="0%" stop-color="#fff7ed"/>
        <stop offset="100%" stop-color="#fef2f2"/>
      </linearGradient>
      <filter id="fragNetShadow">
        <feDropShadow dx="0" dy="3" stdDeviation="5" flood-opacity="0.12"/>
      </filter>
    </defs>
    <rect width="680" height="185" fill="url(#fragBg)" rx="10"/>

    <!-- US Network -->
    <g transform="translate(115,93)">
      <circle r="57" fill="url(#usGrad)" stroke="#ea580c" stroke-width="3" stroke-dasharray="8,5" filter="url(#fragNetShadow)"/>
      <!-- Population dots -->
      <circle cx="-20" cy="-16" r="2.8" fill="#dc2626" opacity="0.32"/>
      <circle cx="11" cy="-21" r="2.8" fill="#dc2626" opacity="0.32"/>
      <circle cx="27" cy="6" r="2.8" fill="#dc2626" opacity="0.32"/>
      <circle cx="-11" cy="21" r="2.8" fill="#dc2626" opacity="0.32"/>
      <circle cx="-31" cy="11" r="2.8" fill="#dc2626" opacity="0.32"/>
      <circle cx="16" cy="26" r="2.8" fill="#dc2626" opacity="0.32"/>
      <!-- Badge -->
      <rect x="-40" y="-8" width="80" height="22" rx="6" fill="white" opacity="0.7"/>
      <text y="-8" text-anchor="middle" font-size="13" fill="#dc2626" font-weight="700" font-family="'DM Sans', system-ui, sans-serif">&#x1F1FA;&#x1F1F8;</text>
      <text y="10" text-anchor="middle" font-size="13" fill="#ea580c" font-weight="700" font-family="'DM Sans', system-ui, sans-serif">US Net</text>
    </g>

    <!-- CN Network -->
    <g transform="translate(340,93)">
      <circle r="57" fill="url(#cnGrad)" stroke="#ea580c" stroke-width="3" stroke-dasharray="8,5" filter="url(#fragNetShadow)"/>
      <circle cx="-25" cy="-21" r="2.8" fill="#dc2626" opacity="0.38"/>
      <circle cx="6" cy="-26" r="2.8" fill="#dc2626" opacity="0.38"/>
      <circle cx="29" cy="-11" r="2.8" fill="#dc2626" opacity="0.38"/>
      <circle cx="21" cy="21" r="2.8" fill="#dc2626" opacity="0.38"/>
      <circle cx="-16" cy="26" r="2.8" fill="#dc2626" opacity="0.38"/>
      <circle cx="-31" cy="6" r="2.8" fill="#dc2626" opacity="0.38"/>
      <rect x="-40" y="-8" width="80" height="22" rx="6" fill="white" opacity="0.7"/>
      <text y="-8" text-anchor="middle" font-size="13" fill="#dc2626" font-weight="700" font-family="'DM Sans', system-ui, sans-serif">&#x1F1E8;&#x1F1F3;</text>
      <text y="10" text-anchor="middle" font-size="13" fill="#ea580c" font-weight="700" font-family="'DM Sans', system-ui, sans-serif">CN Net</text>
    </g>

    <!-- EU Network -->
    <g transform="translate(565,93)">
      <circle r="57" fill="url(#euGrad)" stroke="#2563eb" stroke-width="3" stroke-dasharray="8,5" filter="url(#fragNetShadow)"/>
      <circle cx="-21" cy="-19" r="2.8" fill="#2563eb" opacity="0.32"/>
      <circle cx="13" cy="-23" r="2.8" fill="#2563eb" opacity="0.32"/>
      <circle cx="27" cy="9" r="2.8" fill="#2563eb" opacity="0.32"/>
      <circle cx="-9" cy="23" r="2.8" fill="#2563eb" opacity="0.32"/>
      <circle cx="-29" cy="9" r="2.8" fill="#2563eb" opacity="0.32"/>
      <rect x="-40" y="-8" width="80" height="22" rx="6" fill="white" opacity="0.7"/>
      <text y="-8" text-anchor="middle" font-size="13" fill="#1d4ed8" font-weight="700" font-family="'DM Sans', system-ui, sans-serif">&#x1F1EA;&#x1F1FA;</text>
      <text y="10" text-anchor="middle" font-size="13" fill="#ea580c" font-weight="700" font-family="'DM Sans', system-ui, sans-serif">EU Net</text>
    </g>

    <!-- Broken connections with crossing lines -->
    <line x1="178" y1="88" x2="280" y2="88" stroke="#fca5a5" stroke-width="2" stroke-dasharray="4,6"/>
    <line x1="403" y1="88" x2="505" y2="88" stroke="#fca5a5" stroke-width="2" stroke-dasharray="4,6"/>
    <!-- Cross markers -->
    <line x1="221" y1="73" x2="238" y2="90" stroke="#dc2626" stroke-width="3.5" stroke-linecap="round"/>
    <line x1="238" y1="73" x2="221" y2="90" stroke="#dc2626" stroke-width="3.5" stroke-linecap="round"/>
    <line x1="446" y1="73" x2="463" y2="90" stroke="#dc2626" stroke-width="3.5" stroke-linecap="round"/>
    <line x1="463" y1="73" x2="446" y2="90" stroke="#dc2626" stroke-width="3.5" stroke-linecap="round"/>
    <!-- Labels above breaks -->
    <rect x="200" y="54" width="60" height="16" rx="4" fill="#fee2e2"/>
    <text x="230" y="65" text-anchor="middle" font-size="10" fill="#dc2626" font-weight="700" font-family="'DM Sans', system-ui, sans-serif">Sanctions</text>
    <rect x="426" y="54" width="56" height="16" rx="4" fill="#fee2e2"/>
    <text x="454" y="65" text-anchor="middle" font-size="10" fill="#dc2626" font-weight="700" font-family="'DM Sans', system-ui, sans-serif">Firewall</text>
  </svg>

  <p>Every nation will realize that whoever achieves AGI first wins forever. The power differential will make nuclear weapons look like firecrackers. So they will race. And racing will mean not sharing. The open research culture that created modern AI will die overnight, replaced by Manhattan Project secrecy.</p>

  <div class="pullquote">
    <p>The terrifying truth about this future is its stability. The fear that drives fragmentation is self-reinforcing. Every year of separation makes the other fragments seem more alien and threatening. The fragmentation will not just be technological. It will be ontological.</p>
  </div>

  <hr class="section-divider">

  <!-- Future Three: Human Symbiosis -->
  <h2>Future Three: Human Symbiosis</h2>
  <p style="font-weight:600; color:#16a34a; font-size:0.95rem;">The Wisdom Path. The Path of Conscious Design.</p>

  <p>In 1969, the biologist Lynn Margulis discovered the fundamental pattern of evolutionary leaps. The complex cells that make up our bodies were once independent bacteria that formed a partnership. Cooperation, not just competition, drives the great transitions.</p>

  <p>Human-AI symbiosis follows the same pattern. Not replacement. Not servitude. Partnership at a depth that redefines both partners.</p>

  <p>This future is made possible by the principles we have established. It is an economy built on <strong>Universal Access to Intelligence (UAI)</strong>, where every human is endowed with a Sovereign AI Agent. It is an economy of <strong>Flow</strong>, where <strong>Dual Currencies</strong> enable both physical sustainability and digital abundance. Its governance is not a corporate board or a paranoid state, but the distributed, human-guided <strong>Guardian Lattice</strong>.</p>

  <!-- SVG: Symbiosis partnership — enhanced -->
  <svg viewBox="0 0 680 200" style="display:block; width:100%; margin: 2rem 0;" aria-label="Human-AI symbiosis: two partners forming a unified whole">
    <defs>
      <radialGradient id="humanGrad" cx="40%" cy="45%" r="60%">
        <stop offset="0%" style="stop-color:#bbf7d0;stop-opacity:1" />
        <stop offset="100%" style="stop-color:#16a34a;stop-opacity:0.3" />
      </radialGradient>
      <radialGradient id="aiGrad" cx="60%" cy="45%" r="60%">
        <stop offset="0%" style="stop-color:#bfdbfe;stop-opacity:1" />
        <stop offset="100%" style="stop-color:#2563eb;stop-opacity:0.3" />
      </radialGradient>
      <linearGradient id="overlapGrad" x1="0%" y1="0%" x2="100%" y2="0%">
        <stop offset="0%" style="stop-color:#4ade80;stop-opacity:0.5" />
        <stop offset="50%" style="stop-color:#a3e6c0;stop-opacity="0.6" />
        <stop offset="100%" style="stop-color:#60a5fa;stop-opacity:0.5" />
      </linearGradient>
      <marker id="arrowG" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
        <polygon points="0 0, 8 3, 0 6" fill="#16a34a"/>
      </marker>
      <marker id="arrowB2" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
        <polygon points="0 0, 8 3, 0 6" fill="#2563eb"/>
      </marker>
      <filter id="humanCircGlow" x="-20%" y="-20%" width="140%" height="140%">
        <feDropShadow dx="0" dy="0" stdDeviation="6" flood-color="#16a34a" flood-opacity="0.2"/>
      </filter>
      <filter id="aiCircGlow" x="-20%" y="-20%" width="140%" height="140%">
        <feDropShadow dx="0" dy="0" stdDeviation="6" flood-color="#2563eb" flood-opacity="0.2"/>
      </filter>
      <linearGradient id="symbioBg" x1="0" y1="0" x2="1" y2="1">
        <stop offset="0%" stop-color="#f0fdf4"/>
        <stop offset="100%" stop-color="#eff6ff"/>
      </linearGradient>
    </defs>
    <rect width="680" height="200" fill="url(#symbioBg)" rx="10"/>

    <g transform="translate(340,93)">
      <!-- Human circle -->
      <circle cx="-55" cy="0" r="52" fill="url(#humanGrad)" stroke="#16a34a" stroke-width="2.5" filter="url(#humanCircGlow)"/>
      <!-- Human silhouette suggestion -->
      <circle cx="-55" cy="-20" r="10" fill="#16a34a" opacity="0.38"/>
      <path d="M-72,0 Q-55,-6 -38,0 L-38,20 Q-55,26 -72,20 Z" fill="#16a34a" opacity="0.22"/>
      <text x="-55" y="7" text-anchor="middle" font-size="13" fill="#15803d" font-weight="700" font-family="'DM Sans', system-ui, sans-serif">Human</text>

      <!-- AI circle -->
      <circle cx="55" cy="0" r="52" fill="url(#aiGrad)" stroke="#2563eb" stroke-width="2.5" filter="url(#aiCircGlow)"/>
      <!-- Circuit pattern -->
      <circle cx="55" cy="0" r="7" fill="#2563eb" opacity="0.35"/>
      <line x1="55" y1="-24" x2="55" y2="-9" stroke="#2563eb" stroke-width="1.8" opacity="0.35"/>
      <line x1="32" y1="0" x2="46" y2="0" stroke="#2563eb" stroke-width="1.8" opacity="0.35"/>
      <line x1="64" y1="0" x2="78" y2="0" stroke="#2563eb" stroke-width="1.8" opacity="0.35"/>
      <line x1="55" y1="9" x2="55" y2="24" stroke="#2563eb" stroke-width="1.8" opacity="0.35"/>
      <circle cx="55" cy="-24" r="3.5" fill="#2563eb" opacity="0.38"/>
      <circle cx="78" cy="0" r="3.5" fill="#2563eb" opacity="0.38"/>
      <circle cx="55" cy="24" r="3.5" fill="#2563eb" opacity="0.38"/>
      <text x="55" y="7" text-anchor="middle" font-size="13" fill="#1d4ed8" font-weight="700" font-family="'DM Sans', system-ui, sans-serif">AI</text>

      <!-- Overlap region -->
      <ellipse cx="0" cy="0" rx="22" ry="46" fill="url(#overlapGrad)"/>
      <text x="0" y="-58" text-anchor="middle" font-size="12" fill="#1a1a1a" font-weight="700" font-family="'Playfair Display', Georgia, serif">Partnership</text>

      <!-- Exchange arrows with labels -->
      <path d="M-24,-24 Q0,-44 24,-24" fill="none" stroke="#16a34a" stroke-width="2.5" marker-end="url(#arrowG)"/>
      <text x="0" y="-48" text-anchor="middle" font-size="9" fill="#16a34a" font-weight="600" font-family="'DM Sans', system-ui, sans-serif">Purpose &amp; Values</text>
      <path d="M24,24 Q0,44 -24,24" fill="none" stroke="#2563eb" stroke-width="2.5" marker-end="url(#arrowB2)"/>
      <text x="0" y="61" text-anchor="middle" font-size="9" fill="#2563eb" font-weight="600" font-family="'DM Sans', system-ui, sans-serif">Intelligence &amp; Scale</text>
    </g>

    <!-- Foundation pillars -->
    <g transform="translate(90,170)">
      <rect x="-30" y="-11" width="60" height="20" rx="5" fill="#dcfce7" stroke="#16a34a" stroke-width="1.2"/>
      <text x="0" y="3" text-anchor="middle" font-size="9" fill="#15803d" font-weight="700" font-family="'DM Sans', system-ui, sans-serif">UAI</text>
    </g>
    <g transform="translate(235,170)">
      <rect x="-44" y="-11" width="88" height="20" rx="5" fill="#dbeafe" stroke="#2563eb" stroke-width="1.2"/>
      <text x="0" y="3" text-anchor="middle" font-size="9" fill="#1d4ed8" font-weight="700" font-family="'DM Sans', system-ui, sans-serif">Dual Currency</text>
    </g>
    <g transform="translate(405,170)">
      <rect x="-55" y="-11" width="110" height="20" rx="5" fill="#fef3c7" stroke="#d97706" stroke-width="1.2"/>
      <text x="0" y="3" text-anchor="middle" font-size="9" fill="#92400e" font-weight="700" font-family="'DM Sans', system-ui, sans-serif">Guardian Lattice</text>
    </g>
    <g transform="translate(570,170)">
      <rect x="-48" y="-11" width="96" height="20" rx="5" fill="#f0fdf4" stroke="#16a34a" stroke-width="1.2"/>
      <text x="0" y="3" text-anchor="middle" font-size="9" fill="#15803d" font-weight="700" font-family="'DM Sans', system-ui, sans-serif">Flow Economy</text>
    </g>
  </svg>

  <p>The hardest part of this path is not technological. It is psychological. It requires us to release the equation of work with worth. It requires a conscious choice.</p>

  <hr class="section-divider">

  <!-- Scenario Cards (PRESERVED) -->
  <div class="panel">
    <h2>Choose a Future</h2>
    <p style="font-size:0.9rem; color:#666;">Click a scenario to explore what each future looks like.</p>
    <div class="scenario-cards">
      <div class="scenario-card" data-scenario="feudal" onclick="selectScenario('feudal')">
        <div class="scenario-icon">&#x1F3F0;</div>
        <h3>Digital Feudalism</h3>
        <p>AI controlled by a handful of lords</p>
      </div>
      <div class="scenario-card" data-scenario="fragment" onclick="selectScenario('fragment')">
        <div class="scenario-icon">&#x1F30D;</div>
        <h3>Great Fragmentation</h3>
        <p>Splintered blocs, digital borders</p>
      </div>
      <div class="scenario-card active" data-scenario="symbiosis" onclick="selectScenario('symbiosis')">
        <div class="scenario-icon">&#x1F331;</div>
        <h3>Human Symbiosis</h3>
        <p>Shared intelligence, shared flourishing</p>
      </div>
    </div>

    <div id="scenario-detail" style="margin-top:1rem;">
      <table class="comparison-table">
        <thead>
          <tr><th>Dimension</th><th id="col-feudal">Feudalism</th><th id="col-fragment">Fragmentation</th><th id="col-symbiosis" style="background:#eff6ff;">Symbiosis</th></tr>
        </thead>
        <tbody>
          <tr><td>AI ownership</td><td>3-5 corporations</td><td>National champions</td><td>Commons + open models</td></tr>
          <tr><td>Wealth distribution</td><td>Neo-aristocracy</td><td>Regional inequality</td><td>Broad-based dividend</td></tr>
          <tr><td>Governance</td><td>Corporate capture</td><td>Techno-nationalism</td><td>Transparent, participatory</td></tr>
          <tr><td>Individual agency</td><td>Platform serfs</td><td>Walled citizens</td><td>Empowered symbiotes</td></tr>
          <tr><td>Innovation rate</td><td>High but narrow</td><td>Duplicated effort</td><td>Combinatorial explosion</td></tr>
        </tbody>
      </table>
    </div>

    <div id="scenario-timeline" class="timeline">
      <div class="timeline-event symbiosis">
        <div class="timeline-year">2025-2027</div>
        <div class="timeline-text">Open-source AI reaches parity; cooperative governance pilots begin</div>
      </div>
      <div class="timeline-event symbiosis">
        <div class="timeline-year">2028-2030</div>
        <div class="timeline-text">Symbiotic protocols standardized; first universal AI dividend trials</div>
      </div>
      <div class="timeline-event symbiosis">
        <div class="timeline-year">2031-2035</div>
        <div class="timeline-text">Post-scarcity transition in knowledge work; ecological restoration at scale</div>
      </div>
    </div>
  </div>

  <hr class="section-divider">

  <!-- The Strategy of Nucleation -->
  <h2>The Strategy of Nucleation: How the Best Future Wins</h2>

  <p>We must be brutally honest about the odds. Out of a hundred possible timelines branching from this moment, the vast majority end in some form of feudalism or fragmentation. Digital Feudalism is the default path of least resistance. The Great Fragmentation is the stable valley of fear. The path to Human Symbiosis is a narrow ridgeline of possibility, requiring deliberate, constant effort to walk.</p>

  <p>How can this rare future possibly win? It will not win through a global, top-down decision. It will win through the physics of <strong>nucleation</strong>.</p>

  <div class="pullquote">
    <p>A phase transition does not happen everywhere at once. It starts at a single point &mdash; a &ldquo;nucleation site&rdquo; &mdash; where the new, more stable configuration can take hold. From there, it spreads rapidly until the entire system has crystallized into the new form.</p>
  </div>

  <p>The Renaissance did not happen everywhere; it nucleated in Florence. The Scientific Revolution nucleated in the Royal Society. Our strategy must be to create the <strong>Florences of the 21st century</strong>: small-scale, protected, and intensely successful &ldquo;Symbiotic Zones.&rdquo; These could be cities, companies, or digital networks that go all in on the symbiotic model. Their task is to become so demonstrably prosperous, resilient, and humanly fulfilling that their model becomes irresistible.</p>

  <!-- SVG: Nucleation spreading — enhanced -->
  <svg viewBox="0 0 680 150" style="display:block; width:100%; margin: 2rem 0;" aria-label="Nucleation sites spreading the symbiotic model outward">
    <defs>
      <radialGradient id="nucBg" cx="50%" cy="50%" r="70%">
        <stop offset="0%" stop-color="#f0fdf4"/>
        <stop offset="100%" stop-color="#dcfce7"/>
      </radialGradient>
      <radialGradient id="seedGrad" cx="40%" cy="35%" r="65%">
        <stop offset="0%" stop-color="#4ade80"/>
        <stop offset="100%" stop-color="#15803d"/>
      </radialGradient>
      <filter id="seedGlow">
        <feDropShadow dx="0" dy="0" stdDeviation="5" flood-color="#16a34a" flood-opacity="0.4"/>
      </filter>
    </defs>
    <rect width="680" height="150" fill="url(#nucBg)" rx="10"/>
    <!-- Spreading rings -->
    <circle cx="340" cy="72" r="72" fill="none" stroke="#16a34a" stroke-width="0.8" opacity="0.18" stroke-dasharray="4,3"/>
    <circle cx="340" cy="72" r="52" fill="none" stroke="#16a34a" stroke-width="1" opacity="0.3" stroke-dasharray="4,3"/>
    <circle cx="340" cy="72" r="32" fill="none" stroke="#16a34a" stroke-width="1.5" opacity="0.55"/>
    <!-- Central seed -->
    <circle cx="340" cy="72" r="14" fill="url(#seedGrad)" filter="url(#seedGlow)"/>
    <text x="340" y="76" text-anchor="middle" font-size="9" fill="white" font-weight="700" font-family="'DM Sans', system-ui, sans-serif">Seed</text>
    <!-- Satellite seeds -->
    <circle cx="248" cy="51" r="8" fill="url(#seedGrad)" opacity="0.75" filter="url(#seedGlow)"/>
    <circle cx="433" cy="56" r="8" fill="url(#seedGrad)" opacity="0.75" filter="url(#seedGlow)"/>
    <circle cx="298" cy="116" r="8" fill="url(#seedGrad)" opacity="0.75" filter="url(#seedGlow)"/>
    <circle cx="402" cy="112" r="8" fill="url(#seedGrad)" opacity="0.75" filter="url(#seedGlow)"/>
    <!-- Labels -->
    <text x="128" y="77" font-size="11" fill="#555" text-anchor="middle" font-family="'DM Sans', system-ui, sans-serif">Cities</text>
    <text x="550" y="77" font-size="11" fill="#555" text-anchor="middle" font-family="'DM Sans', system-ui, sans-serif">Digital networks</text>
    <text x="340" y="143" font-size="10" fill="#888" text-anchor="middle" font-family="'DM Sans', system-ui, sans-serif">Transition through overwhelmingly successful imitation</text>
  </svg>

  <p>This is also our only viable strategy in the <strong>Great AGI Race</strong>. A closed, authoritarian system may be good at amassing data, but it is terrible at fostering the trust and variety necessary for true innovation and, most importantly, for solving the Alignment Problem. The race for AGI will not be won by the nation with the most GPUs. It will be won by the society with the healthiest MIND portfolio. The symbiotic model is not just our best hope for a good future; it is our only viable strategy for winning the race.</p>

  <!-- Panel: Phase Landscape with Parameter Sliders (PRESERVED) -->
  <div class="panel">
    <h2>Phase Landscape</h2>
    <p style="font-size:0.9rem; color:#666;">Drag the marble or adjust the sliders to explore the attractor basins.</p>
    <svg id="landscape-svg" style="display:block; width:100%; max-width:600px; cursor:pointer;" viewBox="0 0 600 400"></svg>
    <div id="trajectory-label" class="trajectory-label" style="background:#fef2f2; color:#dc2626;">Current trajectory: Digital Feudalism</div>

    <div class="slider-row">
      <label>AI Openness: <span id="open-val">30</span></label>
      <div class="slider-label"><span>Closed / Proprietary</span><span>Fully Open</span></div>
      <input type="range" id="open-slider" min="0" max="100" value="30">
    </div>
    <div class="slider-row">
      <label>Wealth Concentration: <span id="wealth-val">70</span></label>
      <div class="slider-label"><span>Distributed</span><span>Concentrated</span></div>
      <input type="range" id="wealth-slider" min="0" max="100" value="70">
    </div>
    <div class="slider-row">
      <label>Governance Transparency: <span id="gov-val">20</span></label>
      <div class="slider-label"><span>Opaque</span><span>Transparent</span></div>
      <input type="range" id="gov-slider" min="0" max="100" value="20">
    </div>

    <div class="btn-group">
      <button class="btn secondary" onclick="setPreset('feudal')">Preset: Feudalism</button>
      <button class="btn secondary" onclick="setPreset('fragment')">Preset: Fragmentation</button>
      <button class="btn secondary" onclick="setPreset('symbiosis')">Preset: Symbiosis</button>
    </div>
    <p class="caption">The landscape shows three attractor basins. Small changes in AI openness, wealth distribution, and governance transparency determine which future crystallizes.</p>
  </div>

  <hr class="section-divider">

  <!-- The Call to the Nucleators -->
  <h2>The Call to the Nucleators</h2>

  <p>This, then, is the strategy. We do not need to convert the world overnight. We need to build the first, undeniable proof points.</p>

  <p>The choice presented by the three futures is not a global ballot we all cast at once. It is a choice made by individuals, teams, and communities to begin building a different kind of system in their own corner of the world. It is the choice to found a company on symbiotic principles. It is the choice to turn a city into a laboratory for a new social contract. It is the choice to build a digital network that shares value instead of extracting it.</p>

  <div class="pullquote">
    <p>The old world will not be defeated in a final battle. It will be made obsolete by a thousand interconnected, overwhelmingly successful prototypes of the new one.</p>
  </div>

  <!-- Tipping Point Countdown (PRESERVED) -->
  <div class="panel">
    <h2>The Window Is Closing</h2>
    <p style="font-size:0.9rem; color:#666;">Estimated time remaining in the decision window before path-lock.</p>
    <div class="countdown" id="countdown">--</div>
    <div class="countdown-sub">days until estimated crystallization</div>
    <p class="caption">This is a conceptual estimate. The point is not the exact number but the narrowing window for collective choice. Every policy enacted, every model released, every institution built shifts the marble.</p>
  </div>

  <p>The crucial insight is that these futures are <em>not</em> equally likely. The default trajectory &mdash; do nothing, change nothing &mdash; leads to Digital Feudalism. The Great Fragmentation requires active but misguided intervention. Human Symbiosis requires <em>deliberate, coordinated, sustained</em> effort.</p>

  <p>The question is not &ldquo;How can we save the world?&rdquo; The question is <strong>&ldquo;Where do we build the first seed?&rdquo;</strong></p>

  <p>The next chapters map the institutions, policies, and technologies that can nudge the marble toward symbiosis &mdash; before the crystal sets.</p>

</div>

<script>
(function() {
  var els = document.querySelectorAll('.panel, .illustration, .pullquote, .stat-callout, .panel-full');
  els.forEach(function(el) {
    el.style.opacity = '0';
    el.style.transform = 'translateY(20px)';
    el.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
  });
  var io = new IntersectionObserver(function(entries) {
    entries.forEach(function(e) {
      if (e.isIntersecting) {
        e.target.style.opacity = '1';
        e.target.style.transform = 'translateY(0)';
        io.unobserve(e.target);
      }
    });
  }, { threshold: 0.1 });
  els.forEach(function(el) { io.observe(el); });
})();
</script>
<script>
// ========== Progress Bar ==========
window.addEventListener('scroll', () => {
  const p = document.documentElement;
  document.getElementById('progress-bar').style.width = (p.scrollTop / (p.scrollHeight - p.clientHeight) * 100) + '%';
});

// ========== Scenario Cards ==========
const timelines = {
  feudal: [
    { year: '2025-2027', text: 'Consolidation wave: top 3 AI labs absorb competitors', cls: 'feudal' },
    { year: '2028-2030', text: 'Platform dependency locks in; gig economy expands to knowledge work', cls: 'feudal' },
    { year: '2031-2035', text: 'Neo-aristocracy crystallizes; social mobility collapses', cls: 'feudal' },
  ],
  fragment: [
    { year: '2025-2027', text: 'Export controls escalate; regional AI stacks diverge', cls: 'fragment' },
    { year: '2028-2030', text: 'Digital borders harden; interoperability collapses', cls: 'fragment' },
    { year: '2031-2035', text: 'Balkanized internet; duplicated infrastructure, wasted potential', cls: 'fragment' },
  ],
  symbiosis: [
    { year: '2025-2027', text: 'Open-source AI reaches parity; cooperative governance pilots begin', cls: 'symbiosis' },
    { year: '2028-2030', text: 'Symbiotic protocols standardized; first universal AI dividend trials', cls: 'symbiosis' },
    { year: '2031-2035', text: 'Post-scarcity transition in knowledge work; ecological restoration at scale', cls: 'symbiosis' },
  ],
};

function selectScenario(scenario) {
  document.querySelectorAll('.scenario-card').forEach(c => c.classList.remove('active'));
  document.querySelector(`.scenario-card[data-scenario="${scenario}"]`).classList.add('active');

  // Highlight column
  ['feudal', 'fragment', 'symbiosis'].forEach(s => {
    document.getElementById('col-' + s).style.background = s === scenario ? '#eff6ff' : '';
  });

  // Update timeline
  const container = document.getElementById('scenario-timeline');
  container.innerHTML = timelines[scenario].map(e =>
    `<div class="timeline-event ${e.cls}"><div class="timeline-year">${e.year}</div><div class="timeline-text">${e.text}</div></div>`
  ).join('');
}

// ========== Phase Landscape ==========
(function(){
  const svg = d3.select('#landscape-svg');
  const w = 600, h = 400;

  // Three attractor positions
  const attractors = [
    { x: 150, y: 320, label: 'Digital Feudalism', color: '#dc2626' },
    { x: 450, y: 320, label: 'Great Fragmentation', color: '#ea580c' },
    { x: 300, y: 80, label: 'Human Symbiosis', color: '#16a34a' },
  ];

  // Generate contour data
  const nx = 60, ny = 40;
  const values = new Array(nx * ny);
  for (let j = 0; j < ny; j++) {
    for (let i = 0; i < nx; i++) {
      const px = (i / nx) * w, py = (j / ny) * h;
      let v = 0;
      attractors.forEach(a => {
        const dx = px - a.x, dy = py - a.y;
        v += 100 * Math.exp(-(dx * dx + dy * dy) / 15000);
      });
      values[j * nx + i] = v;
    }
  }

  const contours = d3.contours().size([nx, ny]).thresholds(d3.range(10, 100, 8))(values);
  const xScale = d3.scaleLinear().domain([0, nx]).range([0, w]);
  const yScale = d3.scaleLinear().domain([0, ny]).range([0, h]);
  const path = d3.geoPath(d3.geoTransform({
    point: function(x, y) { this.stream.point(xScale(x), yScale(y)); }
  }));
  const colorScale = d3.scaleSequential(d3.interpolateGreens).domain([0, 100]);

  svg.append('rect').attr('width', w).attr('height', h).attr('fill', '#f0fdf4').attr('rx', 6);
  svg.selectAll('path.contour').data(contours).enter().append('path')
    .attr('d', path).attr('fill', d => colorScale(d.value)).attr('stroke', '#bbb').attr('stroke-width', 0.3).attr('opacity', 0.5);

  // Labels
  attractors.forEach(a => {
    svg.append('text').attr('x', a.x).attr('y', a.y + 5)
      .attr('text-anchor', 'middle').attr('font-size', 12).attr('font-weight', 700)
      .attr('fill', a.color).attr('font-family', "'DM Sans', system-ui, sans-serif").text(a.label);
  });

  // Trail
  const trail = svg.append('path').attr('fill', 'none').attr('stroke', '#2563eb').attr('stroke-width', 1.5).attr('stroke-dasharray', '4,3').attr('opacity', 0.5);
  let trailPoints = [];

  // Marble
  let marbleX = 180, marbleY = 280;
  const marble = svg.append('circle').attr('cx', marbleX).attr('cy', marbleY)
    .attr('r', 10).attr('fill', '#2563eb').attr('stroke', '#fff').attr('stroke-width', 3)
    .attr('cursor', 'grab').attr('filter', 'drop-shadow(0 2px 4px rgba(0,0,0,0.3))');

  const marbleShadow = svg.append('circle').attr('cx', marbleX).attr('cy', marbleY + 2)
    .attr('r', 8).attr('fill', 'rgba(0,0,0,0.1)').lower();

  // Drag marble
  marble.call(d3.drag()
    .on('start', function() { trailPoints = [{x: marbleX, y: marbleY}]; })
    .on('drag', function(event) {
      marbleX = Math.max(20, Math.min(w - 20, event.x));
      marbleY = Math.max(20, Math.min(h - 20, event.y));
      trailPoints.push({x: marbleX, y: marbleY});
      if (trailPoints.length > 80) trailPoints.shift();
      trail.attr('d', d3.line().x(d => d.x).y(d => d.y).curve(d3.curveBasis)(trailPoints));
      updateMarble();
    })
  );

  function updateMarble() {
    marble.transition().duration(100).attr('cx', marbleX).attr('cy', marbleY);
    marbleShadow.transition().duration(100).attr('cx', marbleX).attr('cy', marbleY + 2);
    updateTrajectory();
  }

  function updateTrajectory() {
    let closest = attractors[0], minDist = Infinity;
    attractors.forEach(a => {
      const d = Math.hypot(marbleX - a.x, marbleY - a.y);
      if (d < minDist) { minDist = d; closest = a; }
    });
    const label = document.getElementById('trajectory-label');
    label.textContent = 'Current trajectory: ' + closest.label;
    label.style.color = closest.color;
    label.style.background = closest.color + '11';
  }

  // Slider controls
  function computeMarbleFromSliders() {
    const openness = +document.getElementById('open-slider').value;
    const wealth = +document.getElementById('wealth-slider').value;
    const gov = +document.getElementById('gov-slider').value;

    marbleX = 100 + (wealth / 100) * 400 * 0.5 + ((100 - openness) / 100) * 200 * 0.5;
    marbleY = 350 - (gov / 100) * 200 - (openness / 100) * 100;
    marbleX = Math.max(40, Math.min(w - 40, marbleX));
    marbleY = Math.max(40, Math.min(h - 40, marbleY));
    trailPoints = [];
    trail.attr('d', '');
    updateMarble();
  }

  ['open-slider', 'wealth-slider', 'gov-slider'].forEach(id => {
    document.getElementById(id).addEventListener('input', function() {
      const valId = id.replace('-slider', '-val');
      document.getElementById(valId).textContent = this.value;
      computeMarbleFromSliders();
    });
  });

  // Presets
  window.setPreset = function(preset) {
    const presets = {
      feudal: { open: 10, wealth: 95, gov: 5 },
      fragment: { open: 40, wealth: 60, gov: 30 },
      symbiosis: { open: 90, wealth: 15, gov: 85 },
    };
    const p = presets[preset];
    document.getElementById('open-slider').value = p.open;
    document.getElementById('open-val').textContent = p.open;
    document.getElementById('wealth-slider').value = p.wealth;
    document.getElementById('wealth-val').textContent = p.wealth;
    document.getElementById('gov-slider').value = p.gov;
    document.getElementById('gov-val').textContent = p.gov;
    computeMarbleFromSliders();
  };

  updateTrajectory();
})();

// ========== Countdown ==========
(function(){
  // Conceptual crystallization date: end of 2030
  const target = new Date('2030-12-31T00:00:00');
  function update() {
    const now = new Date();
    const days = Math.max(0, Math.floor((target - now) / (1000 * 60 * 60 * 24)));
    document.getElementById('countdown').textContent = days.toLocaleString();
  }
  update();
  setInterval(update, 86400000);
})();
</script>
</body>
</html>
