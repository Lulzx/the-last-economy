<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ch 4 — The GDP Illusion</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=DM+Mono:ital,wght@0,300;0,400;0,500;1,300;1,400;1,500&family=DM+Sans:ital,opsz,wght@0,9..40,100..900;1,9..40,100..900&family=Playfair+Display:ital,wght@0,400..900;1,400..900&display=swap" rel="stylesheet">
<script src="https://d3js.org/d3.v7.min.js"></script>
<style>
body { background: #fafaf8; color: #1a1a1a; font-family: 'DM Sans', system-ui, sans-serif; margin: 0; }
.prose { max-width: 680px; margin: 0 auto; padding: 2rem 1.5rem; font-family: 'DM Sans', system-ui, sans-serif; line-height: 1.7; font-size: 1.05rem; }
.scrub { border-bottom: 2px dashed #2563eb; color: #2563eb; cursor: ew-resize; user-select: none; font-weight: 600; padding: 0 2px; }
.panel { background: white; border: 1px solid #e5e5e0; border-radius: 8px; padding: 1.5rem; margin: 2rem 0; box-shadow: 0 1px 3px rgba(0,0,0,0.08); }
.panel-full { background: white; border-top: 1px solid #e5e5e0; border-bottom: 1px solid #e5e5e0; padding: 2rem; margin: 2rem -1.5rem; }
h1 { font-family: 'Playfair Display', Georgia, serif; font-size: 2rem; font-weight: 700; margin-bottom: 0.5rem; }
h2 { font-family: 'Playfair Display', Georgia, serif; font-size: 1.3rem; font-weight: 600; margin-top: 2rem; }
.chapter-num { color: #888; font-size: 0.85rem; text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: 0.5rem; font-family: 'DM Sans', system-ui, sans-serif; }
.nav { display: flex; justify-content: space-between; padding: 1rem 1.5rem; border-bottom: 1px solid #e5e5e0; font-size: 0.9rem; }
.nav a { color: #2563eb; text-decoration: none; }

svg text { font-family: 'DM Sans', system-ui, sans-serif; }

/* Enrichment styles */
.pullquote { border-left: 4px solid #2563eb; margin: 2rem 0; padding: 1rem 1.5rem; background: #eff6ff; border-radius: 0 8px 8px 0; }
.pullquote p { font-size: 1.15rem; font-style: italic; color: #1e40af; margin: 0; }
.pullquote .pullquote-attr { font-size: 0.85rem; font-style: normal; color: #555; margin-top: 0.5rem; }
.stat-callout { display: flex; flex-direction: column; align-items: center; padding: 1.5rem; background: white; border: 1px solid #e5e5e0; border-radius: 8px; margin: 1.5rem 0; text-align: center; }
.stat-number { font-family: 'Playfair Display', Georgia, serif; font-size: 3rem; font-weight: 700; color: #2563eb; line-height: 1; }
.stat-label { font-size: 0.9rem; color: #555; margin-top: 0.5rem; }
.stat-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 1rem; margin: 1.5rem 0; }
.section-divider { border: none; border-top: 1px solid #e5e5e0; margin: 3rem 0; }
.svg-illustration { display: flex; justify-content: center; margin: 2rem 0; }

/* GDP Paradox Cards */
.card-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(185px, 1fr)); gap: 1rem; }
.event-card { border: 1px solid #e5e5e0; border-radius: 8px; padding: 1rem; cursor: pointer; transition: all 0.3s; min-height: 160px; display: flex; flex-direction: column; }
.event-card.answered { cursor: default; }
.event-name { font-weight: 600; font-size: 0.95rem; margin-bottom: 0.75rem; }
.event-q { font-size: 0.85rem; color: #555; margin-bottom: 0.75rem; }
.event-btns { display: flex; gap: 0.5rem; margin-top: auto; }
.event-btns button { flex: 1; padding: 0.4rem; border-radius: 5px; border: 1px solid #ddd; background: white; cursor: pointer; font-weight: 600; font-size: 0.85rem; transition: all 0.15s; font-family: 'DM Sans', system-ui, sans-serif; }
.event-btns button:hover { border-color: #2563eb; background: #eff6ff; }
.event-btns button.correct { background: #dcfce7; border-color: #16a34a; color: #16a34a; }
.event-btns button.wrong { background: #fef2f2; border-color: #ef4444; color: #ef4444; }
.event-explain { font-size: 0.8rem; color: #555; margin-top: 0.75rem; line-height: 1.4; display: none; }
.event-card.answered .event-explain { display: block; }
.event-card.answered .event-btns { display: none; }
.tally { font-size: 1rem; font-weight: 600; margin-top: 1rem; color: #2563eb; }

/* Wage-Productivity */
.slider-row { display: flex; align-items: center; gap: 0.75rem; margin: 0.4rem 0; font-size: 0.85rem; }
.slider-row label { width: 220px; flex-shrink: 0; }
.slider-row input[type=range] { flex: 1; accent-color: #2563eb; cursor: pointer; }
.slider-row .val { width: 40px; text-align: right; font-weight: 600; }

/* Legend for blame sliders */
.blame-legend { display: flex; flex-wrap: wrap; gap: 0.75rem; margin-top: 0.75rem; font-size: 0.8rem; }
.blame-legend span { display: flex; align-items: center; gap: 0.35rem; }
.blame-legend .swatch { width: 12px; height: 12px; border-radius: 2px; display: inline-block; }
</style>
</head>
<body>
<nav class="nav">
  <a href="seven-lies.html">&larr; Previous</a>
  <a href="explorables.html">All Chapters</a>
  <a href="ch5-trial-by-fire.html">Next &rarr;</a>
</nav>

<div class="prose">
  <div class="chapter-num">Chapter 4</div>
  <h1>The Dashboard for Insanity</h1>

  <div class="pullquote">
    <p>"Not everything that can be counted counts, and not everything that counts can be counted."</p>
    <div class="pullquote-attr">&mdash; William Bruce Cameron</div>
  </div>

  <p>Imagine you are piloting a Boeing 747 through a violent storm. The wings are on fire and the plane is in a nosedive. But you remain calm. You point to the instrument panel. "Do not worry," you say reassuringly. "The cabin pressure is stable, and the in-flight movie is playing perfectly. According to our dashboard, everything is fine."</p>

  <p>This is the state of modern economics. We are flying a civilization through the storm of the century, guided by a dashboard that is not just broken, but criminally insane. That dashboard is called <strong>Gross Domestic Product</strong>.</p>

  <!-- SVG: Broken Dashboard Illustration -->
  <div class="svg-illustration">
    <svg viewBox="0 0 400 200" width="400" height="200" role="img" aria-label="A broken cockpit dashboard showing misleading green indicators while the plane is in crisis">
      <!-- Cockpit frame -->
      <rect x="20" y="20" width="360" height="160" rx="12" fill="#1a1a1a" stroke="#333" stroke-width="2"/>
      <!-- Dashboard panel -->
      <rect x="40" y="40" width="320" height="120" rx="8" fill="#222"/>
      <!-- Gauge 1: GDP - green, "all good" -->
      <circle cx="110" cy="100" r="40" fill="none" stroke="#333" stroke-width="3"/>
      <path d="M110 100 L110 65" stroke="#16a34a" stroke-width="3" stroke-linecap="round"/>
      <circle cx="110" cy="100" r="4" fill="#16a34a"/>
      <text x="110" y="150" text-anchor="middle" fill="#16a34a" font-size="10" font-weight="600">GDP</text>
      <text x="110" y="73" text-anchor="middle" fill="#16a34a" font-size="8">GREAT</text>
      <!-- Gauge 2: Wellbeing - red, critical -->
      <circle cx="200" cy="100" r="40" fill="none" stroke="#333" stroke-width="3"/>
      <path d="M200 100 L230 120" stroke="#ef4444" stroke-width="3" stroke-linecap="round"/>
      <circle cx="200" cy="100" r="4" fill="#ef4444"/>
      <text x="200" y="150" text-anchor="middle" fill="#ef4444" font-size="10" font-weight="600">Wellbeing</text>
      <text x="218" y="128" text-anchor="start" fill="#ef4444" font-size="7">CRISIS</text>
      <!-- Gauge 3: Planet - red, critical -->
      <circle cx="290" cy="100" r="40" fill="none" stroke="#333" stroke-width="3"/>
      <path d="M290 100 L318 115" stroke="#ef4444" stroke-width="3" stroke-linecap="round"/>
      <circle cx="290" cy="100" r="4" fill="#ef4444"/>
      <text x="290" y="150" text-anchor="middle" fill="#ef4444" font-size="10" font-weight="600">Planet</text>
      <text x="306" y="122" text-anchor="start" fill="#ef4444" font-size="7">CRISIS</text>
      <!-- Warning lights -->
      <circle cx="55" cy="55" r="5" fill="#ef4444" opacity="0.9">
        <animate attributeName="opacity" values="0.9;0.3;0.9" dur="1.2s" repeatCount="indefinite"/>
      </circle>
      <circle cx="345" cy="55" r="5" fill="#ef4444" opacity="0.3">
        <animate attributeName="opacity" values="0.3;0.9;0.3" dur="1.2s" repeatCount="indefinite"/>
      </circle>
    </svg>
  </div>

  <p>GDP is our economic north star. It is the number that rules the world. Every government chases it, every policy targets it, every news report breathlessly announces its quarterly change. Simon Kuznets, the man who invented the metric in the 1930s, spent the rest of his life warning us not to use it as a measure of a nation's wellbeing. We ignored him completely.</p>

  <p>The result is a world where every metric that matters shows crisis, while the one metric we track shows success.</p>

  <hr class="section-divider">

  <!-- ═════════════════════════════════ -->
  <!-- The Perversity Gallery            -->
  <!-- ═════════════════════════════════ -->
  <h2>The Perversity Gallery</h2>
  <p>Let me show you through the hall of mirrors that is modern economic measurement. Each exhibit is more grotesque than the last, and each one is counted as "growth."</p>

  <!-- Panel 1: GDP Paradox Calculator -->
  <div class="panel">
    <h2 style="margin-top:0">The GDP Paradox Calculator</h2>
    <p style="font-size:0.9rem;color:#666;margin-top:0">For each event, guess: does GDP go UP or DOWN?</p>
    <div class="card-grid" id="paradox-grid"></div>
    <div class="tally" id="tally"></div>
  </div>

  <p><strong>The Hurricane Economy.</strong> When a hurricane devastates a city, it is a human tragedy. But for GDP, it is a stimulus package. The destruction itself does not register. But the frantic activity that follows &mdash; the rebuilding, the insurance payouts, the emergency services &mdash; is a multi-billion-dollar windfall. By GDP logic, the best possible year would involve every city being destroyed and then rebuilt.</p>

  <div class="stat-callout">
    <div class="stat-number">$425K</div>
    <div class="stat-label">GDP "gain" from a single cancer diagnosis &mdash; diagnostic tests, surgery, chemotherapy, hospital stays, and medications</div>
  </div>

  <p><strong>The Cancer Boom.</strong> A healthy person contributes little to the healthcare economy. But a person diagnosed with lung cancer? That is a windfall for GDP. By this logic, carcinogens are economic stimulants. We have built an economy that is structurally incentivized to manage sickness, not to create health. Prevention is an economic loss; a cure would be an economic catastrophe.</p>

  <p><strong>The Divorce Industrial Complex.</strong> A happy, stable family that raises its own children and supports its community contributes almost nothing to GDP. But when that family breaks apart, the economy booms. Two households instead of one, doubling the consumption. Therapists are hired. Lawyers are paid.</p>

  <div class="stat-callout">
    <div class="stat-number">$50B+</div>
    <div class="stat-label">Added to US GDP by divorce lawyers alone last year. The human tragedy of a broken home is a net positive on the national ledger.</div>
  </div>

  <p><strong>The Planned Obsolescence Museum.</strong> Your phone could be built to last a decade. Apple ensures it will not. Each forced upgrade, each battery that mysteriously degrades, each software update that slows your old device is a victory for GDP. Building products that endure is economic sabotage. Building products designed to be replaced is growth.</p>

  <hr class="section-divider">

  <!-- ═════════════════════════════════ -->
  <!-- Goodhart's Law / Observer Effect  -->
  <!-- ═════════════════════════════════ -->
  <h2>When Measurement Destroys Reality</h2>

  <!-- SVG: Goodhart's Law feedback loop -->
  <div class="svg-illustration">
    <svg viewBox="0 0 400 160" width="400" height="160" role="img" aria-label="Goodhart's Law feedback loop: measure becomes target, target distorts behavior, behavior corrupts measure">
      <!-- Arrows forming a cycle -->
      <defs>
        <marker id="arrowhead" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
          <polygon points="0 0, 8 3, 0 6" fill="#2563eb"/>
        </marker>
      </defs>
      <!-- Box 1: Measure -->
      <rect x="20" y="55" width="100" height="50" rx="8" fill="#eff6ff" stroke="#2563eb" stroke-width="1.5"/>
      <text x="70" y="77" text-anchor="middle" fill="#1e40af" font-size="11" font-weight="600">Measure</text>
      <text x="70" y="93" text-anchor="middle" fill="#1e40af" font-size="9">chosen</text>
      <!-- Arrow 1->2 -->
      <line x1="120" y1="70" x2="148" y2="50" stroke="#2563eb" stroke-width="1.5" marker-end="url(#arrowhead)"/>
      <!-- Box 2: Target -->
      <rect x="150" y="15" width="100" height="50" rx="8" fill="#eff6ff" stroke="#2563eb" stroke-width="1.5"/>
      <text x="200" y="37" text-anchor="middle" fill="#1e40af" font-size="11" font-weight="600">Becomes</text>
      <text x="200" y="53" text-anchor="middle" fill="#1e40af" font-size="9">a target</text>
      <!-- Arrow 2->3 -->
      <line x1="250" y1="50" x2="278" y2="70" stroke="#2563eb" stroke-width="1.5" marker-end="url(#arrowhead)"/>
      <!-- Box 3: Distorts -->
      <rect x="280" y="55" width="100" height="50" rx="8" fill="#fef2f2" stroke="#ef4444" stroke-width="1.5"/>
      <text x="330" y="77" text-anchor="middle" fill="#ef4444" font-size="11" font-weight="600">Distorts</text>
      <text x="330" y="93" text-anchor="middle" fill="#ef4444" font-size="9">behavior</text>
      <!-- Arrow 3->4 -->
      <line x1="330" y1="105" x2="250" y2="125" stroke="#ef4444" stroke-width="1.5" marker-end="url(#arrowhead)"/>
      <!-- Box 4: Corrupts -->
      <rect x="150" y="110" width="100" height="50" rx="8" fill="#fef2f2" stroke="#ef4444" stroke-width="1.5"/>
      <text x="200" y="132" text-anchor="middle" fill="#ef4444" font-size="11" font-weight="600">Corrupts</text>
      <text x="200" y="148" text-anchor="middle" fill="#ef4444" font-size="9">the measure</text>
      <!-- Arrow 4->1 (closing the loop) -->
      <line x1="150" y1="125" x2="120" y2="100" stroke="#ef4444" stroke-width="1.5" marker-end="url(#arrowhead)"/>
    </svg>
  </div>

  <p>The true insanity is not just that GDP counts the wrong things. It is that the very act of counting them changes our reality for the worse. This is <strong>Goodhart's Law</strong>: "When a measure becomes a target, it ceases to be a good measure." In economics, this is not a bug; it is the central operating principle.</p>

  <div class="pullquote">
    <p>We targeted engagement and destroyed connection. The dashboard did not just report the weather; it created it.</p>
  </div>

  <p>Consider the <strong>Engagement Trap</strong>. Social media platforms chose "engagement" as their success metric. The algorithms quickly learned that nothing drives engagement like outrage. Anger is sticky. Fear is addictive. And so, in the name of hitting a metric, the platforms became rage machines, tearing apart the social fabric to optimize a number on a spreadsheet.</p>

  <hr class="section-divider">

  <!-- ═════════════════════════════════ -->
  <!-- The Abundance Paradox             -->
  <!-- ═════════════════════════════════ -->
  <h2>The Abundance Paradox</h2>
  <p>Our dashboard's most fatal flaw is its complete inability to process good news. Our system is designed to measure transactions involving scarce goods. It is therefore structurally blind to abundance. When something becomes abundant and free, our dashboard does not just fail to see its value; it registers its arrival as a <em>negative event</em>.</p>

  <!-- SVG: Abundance vs GDP -->
  <div class="svg-illustration">
    <svg viewBox="0 0 400 180" width="400" height="180" role="img" aria-label="As real value rises through abundance, GDP registers it as decline">
      <!-- Axes -->
      <line x1="60" y1="150" x2="370" y2="150" stroke="#ccc" stroke-width="1"/>
      <line x1="60" y1="150" x2="60" y2="20" stroke="#ccc" stroke-width="1"/>
      <text x="215" y="175" text-anchor="middle" fill="#888" font-size="10">Time</text>
      <text x="15" y="85" text-anchor="middle" fill="#888" font-size="10" transform="rotate(-90,15,85)">Value</text>
      <!-- Real value curve (rising) -->
      <path d="M60 130 Q150 120 200 90 Q260 55 360 30" fill="none" stroke="#16a34a" stroke-width="2.5" stroke-linecap="round"/>
      <text x="362" y="25" fill="#16a34a" font-size="10" font-weight="600">Real value</text>
      <!-- GDP curve (declining) -->
      <path d="M60 130 Q150 132 200 135 Q260 140 360 145" fill="none" stroke="#ef4444" stroke-width="2.5" stroke-linecap="round"/>
      <text x="362" y="148" fill="#ef4444" font-size="10" font-weight="600">GDP</text>
      <!-- Annotation -->
      <text x="200" y="115" text-anchor="middle" fill="#888" font-size="9" font-style="italic">The better things get, the worse GDP looks</text>
    </svg>
  </div>

  <p>The Human Genome Project cost billions and took over a decade. By making the resulting data a public good, it unleashed an estimated <strong>trillion dollars</strong> in new economic and scientific value. Its contribution to GDP? <em>Negative</em>. It made genetic information cheap, undermining business models based on proprietary data.</p>

  <div class="pullquote">
    <p>An AI engineer would call this using the wrong "loss function." We have trained our civilization on a flawed loss function, and we are producing a blurry gray world.</p>
  </div>

  <hr class="section-divider">

  <!-- ═════════════════════════════════ -->
  <!-- The Meaning Crisis                -->
  <!-- ═════════════════════════════════ -->
  <h2>The Meaning Crisis</h2>
  <p>The most devastating consequence of our dashboard is not economic but spiritual. For a century, we have managed our society to maximize GDP. In doing so, we have created a world that is rich in transactions and impoverished in meaning.</p>

  <p><strong>The Friendship Recession.</strong> Deep friendship is a GDP black hole; it produces no transactions. So, our economy has systematically replaced it with monetized substitutes. We have more "friends" on social media than ever and fewer people we can call in a crisis.</p>

  <p><strong>The Purpose Vacuum.</strong> A huge percentage of modern, high-paying jobs are roles that the employees themselves know make no meaningful contribution to the world. We pay handsomely for shuffling papers in a corporate bureaucracy while paying subsistence wages to teachers and caregivers.</p>

  <p><strong>The Attention Annihilation.</strong> An entire trillion-dollar industry has been built to capture and monetize human attention. The result is a population neurologically incapable of deep thought. We are strip-mining human minds and calling it progress.</p>

  <div class="stat-row">
    <div class="stat-callout">
      <div class="stat-number">47%</div>
      <div class="stat-label">of Americans say they are worse off than their parents</div>
    </div>
    <div class="stat-callout">
      <div class="stat-number">+30%</div>
      <div class="stat-label">increase in mental health prescriptions since 2020</div>
    </div>
    <div class="stat-callout">
      <div class="stat-number">1.6</div>
      <div class="stat-label">births per woman &mdash; below replacement rate, signaling civilizational decline</div>
    </div>
  </div>

  <p>While the official story speaks of prosperity, the human story is written in a different ledger. It is told not in stock prices but in the quiet desperation of those who feel left behind: 52 percent of recent college graduates are forced into jobs that do not require their degrees, and trust in our core institutions has fallen to the lowest levels ever recorded.</p>

  <hr class="section-divider">

  <!-- ═════════════════════════════════ -->
  <!-- Panel 2: Wage-Productivity Gap    -->
  <!-- ═════════════════════════════════ -->
  <h2>Where Did the Money Go?</h2>
  <p>If productivity has tripled since the 1970s but wages have barely budged, the surplus went <em>somewhere</em>. Use the chart below to explore the gap, then adjust the sliders to model your theory of where the value was captured.</p>

  <div class="panel">
    <h2 style="margin-top:0">The Wage-Productivity Gap</h2>
    <div id="gap-chart" style="width:100%;max-width:640px;"></div>
    <div style="margin-top:1.5rem;">
      <p style="font-size:0.9rem;color:#666;margin:0 0 0.75rem">What explains the gap? Adjust the sliders (must sum to 100%):</p>
      <div class="slider-row">
        <label>Software non-rivalry</label>
        <input type="range" id="blame-sw" min="0" max="100" value="33">
        <span class="val" id="blame-sw-val">33%</span>
      </div>
      <div class="slider-row">
        <label>Network effects / winner-take-all</label>
        <input type="range" id="blame-net" min="0" max="100" value="33">
        <span class="val" id="blame-net-val">33%</span>
      </div>
      <div class="slider-row">
        <label>Financialization / shareholder primacy</label>
        <input type="range" id="blame-fin" min="0" max="100" value="34">
        <span class="val" id="blame-fin-val">34%</span>
      </div>
      <div class="blame-legend">
        <span><span class="swatch" style="background:#2563eb"></span> Software non-rivalry</span>
        <span><span class="swatch" style="background:#7c3aed"></span> Network effects</span>
        <span><span class="swatch" style="background:#d97706"></span> Financialization</span>
      </div>
    </div>
  </div>

  <hr class="section-divider">

  <!-- ═════════════════════════════════ -->
  <!-- Flying Blind Closing              -->
  <!-- ═════════════════════════════════ -->
  <h2>Flying Blind into the Future</h2>
  <p>This is the dashboard that will guide our response to the Intelligence Inversion.</p>

  <p>When AI automates legal research and makes legal advice nearly free, the dashboard will show the legal sector collapsing, and we will panic. When AI tutors provide world-class, personalized education to every child on Earth for free, the dashboard will show the education sector imploding, and we will try to "save" it. When AI-driven preventative medicine leads to a healthier population, the dashboard will show the healthcare sector shrinking, and we will declare a recession.</p>

  <div class="pullquote">
    <p>We are flying a 747 into a storm with instruments from a hot air balloon. The better our technology makes the world, the worse our gauges will look.</p>
  </div>

  <p>Clinging to GDP is no longer just an academic error; it is a civilization-level suicide pact. The first step to recovery is admitting the dashboard is not just wrong but insane. The second is to build new instruments &mdash; instruments designed not to measure the speed at which we consume the world, but to track our capacity to regenerate it.</p>

  <p style="font-weight:600; color:#2563eb; font-size:1.1rem;">It is time to build the MIND Dashboard.</p>

</div>

<script>
// Scrub interaction
document.querySelectorAll('.scrub').forEach(el => {
  let startX, startVal;
  el.addEventListener('mousedown', e => {
    startX = e.clientX;
    startVal = parseFloat(el.dataset.value);
    const onMove = e => {
      const dx = e.clientX - startX;
      const step = parseFloat(el.dataset.step || 1);
      const min = parseFloat(el.dataset.min || 0);
      const max = parseFloat(el.dataset.max || 100);
      const newVal = Math.min(max, Math.max(min, startVal + Math.round(dx / 5) * step));
      el.dataset.value = newVal;
      el.textContent = newVal + (el.dataset.suffix || '');
      if (el.dataset.update) window[el.dataset.update](newVal);
    };
    const onUp = () => { document.removeEventListener('mousemove', onMove); document.removeEventListener('mouseup', onUp); };
    document.addEventListener('mousemove', onMove);
    document.addEventListener('mouseup', onUp);
    e.preventDefault();
  });
});

// ── GDP Paradox Calculator ──
(function() {
  const events = [
    { name: 'Hurricane Katrina', answer: 'up', explain: 'Rebuilding construction, emergency services, and replacement purchases all add to GDP. Destruction is "good" for GDP.' },
    { name: 'Wikipedia launch', answer: 'down', explain: 'Destroyed the $3B encyclopedia industry. The free replacement contributes $0 to GDP despite being vastly superior.' },
    { name: 'Divorce', answer: 'up', explain: 'Two households instead of one, lawyer fees, duplicate furniture purchases, separate utilities. GDP loves inefficiency.' },
    { name: 'Cancer diagnosis', answer: 'up', explain: 'Average treatment cost: $425K. Chemotherapy, hospital stays, pharmaceuticals. Suffering is GDP gold.' },
    { name: 'Open-source software', answer: 'down', explain: 'Linux, Apache, Python: trillions in value, $0 GDP contribution. Free replacements for expensive proprietary software.' },
    { name: 'GPT-4 launch', answer: 'down', explain: 'Replaces paid copywriting, coding, translation, tutoring. Each displaced dollar of human service is GDP lost.' }
  ];

  let score = 0, answered = 0;
  const grid = document.getElementById('paradox-grid');

  events.forEach((ev, i) => {
    const card = document.createElement('div');
    card.className = 'event-card';
    card.innerHTML = `
      <div class="event-name">${ev.name}</div>
      <div class="event-q">GDP goes...</div>
      <div class="event-btns">
        <button data-choice="up">UP</button>
        <button data-choice="down">DOWN</button>
      </div>
      <div class="event-explain">${ev.explain}</div>
    `;
    card.querySelectorAll('button').forEach(btn => {
      btn.addEventListener('click', () => {
        if (card.classList.contains('answered')) return;
        card.classList.add('answered');
        answered++;
        const correct = btn.dataset.choice === ev.answer;
        if (correct) { score++; btn.classList.add('correct'); }
        else { btn.classList.add('wrong'); }
        // highlight correct one
        card.querySelectorAll('button').forEach(b => {
          if (b.dataset.choice === ev.answer) b.classList.add('correct');
        });
        document.getElementById('tally').textContent = `${score}/${answered} correct` + (answered === events.length ? (score >= 4 ? ' — You see through the illusion.' : ' — GDP is trickier than it looks.') : '');
      });
    });
    grid.appendChild(card);
  });
})();

// ── Wage-Productivity Gap ──
(function() {
  // Simplified index data (base 100 in 1950)
  const years = d3.range(1950, 2025);
  const productivity = years.map(y => {
    if (y <= 1973) return { year: y, val: 100 + (y - 1950) * 3.0 };
    return { year: y, val: 169 + (y - 1973) * 3.47 };
  });
  const wages = years.map(y => {
    if (y <= 1973) return { year: y, val: 100 + (y - 1950) * 3.0 };
    return { year: y, val: 169 + (y - 1973) * 0.9 };
  });

  const container = document.getElementById('gap-chart');
  const cw = container.clientWidth || 640;
  const w = cw, h = 300, m = { top: 20, right: 80, bottom: 35, left: 50 };
  const svg = d3.select('#gap-chart').append('svg')
    .attr('viewBox', `0 0 ${w} ${h}`).style('width', '100%');

  const x = d3.scaleLinear().domain([1950, 2024]).range([m.left, w - m.right]);
  const y = d3.scaleLinear().domain([80, 360]).range([h - m.bottom, m.top]);

  svg.append('g').attr('transform', `translate(0,${h - m.bottom})`)
    .call(d3.axisBottom(x).tickFormat(d3.format('d')).ticks(8))
    .selectAll('text').style('font-size', '10px');
  svg.append('g').attr('transform', `translate(${m.left},0)`)
    .call(d3.axisLeft(y).ticks(6))
    .selectAll('text').style('font-size', '10px');

  svg.append('text').attr('transform', 'rotate(-90)').attr('x', -(h/2)).attr('y', 14)
    .attr('text-anchor', 'middle').style('font-size', '11px').style('fill', '#888').text('Index (1950 = 100)');

  const line = d3.line().x(d => x(d.year)).y(d => y(d.val)).curve(d3.curveMonotoneX);

  // Gap area
  const gapArea = svg.append('path')
    .attr('fill', '#ef444422').attr('stroke', 'none');

  function updateGap() {
    const area = d3.area()
      .x(d => x(d.year))
      .y0((d, i) => y(wages[i].val))
      .y1(d => y(d.val))
      .curve(d3.curveMonotoneX);
    gapArea.datum(productivity.filter(d => d.year >= 1973)).attr('d', area);
  }
  updateGap();

  svg.append('path').datum(productivity).attr('d', line)
    .attr('fill', 'none').attr('stroke', '#2563eb').attr('stroke-width', 2.5);
  svg.append('path').datum(wages).attr('d', line)
    .attr('fill', 'none').attr('stroke', '#ef4444').attr('stroke-width', 2.5);

  // Labels
  const lastProd = productivity[productivity.length - 1];
  const lastWage = wages[wages.length - 1];
  svg.append('text').attr('x', x(lastProd.year) + 5).attr('y', y(lastProd.val) + 4)
    .text('Productivity').style('font-size', '11px').style('fill', '#2563eb').style('font-weight', '600');
  svg.append('text').attr('x', x(lastWage.year) + 5).attr('y', y(lastWage.val) + 4)
    .text('Wages').style('font-size', '11px').style('fill', '#ef4444').style('font-weight', '600');

  // 1973 annotation
  svg.append('line').attr('x1', x(1973)).attr('x2', x(1973))
    .attr('y1', m.top).attr('y2', h - m.bottom)
    .attr('stroke', '#888').attr('stroke-width', 1).attr('stroke-dasharray', '4,3');
  svg.append('text').attr('x', x(1973) + 4).attr('y', m.top + 12)
    .text('1973: divergence begins').style('font-size', '10px').style('fill', '#888');

  // Blame sliders
  const sliders = ['blame-sw', 'blame-net', 'blame-fin'];
  const colors = ['#2563eb', '#7c3aed', '#d97706'];

  // Explanation zone segments in the gap
  const segments = svg.selectAll('.blame-seg').data(sliders).enter().append('rect')
    .attr('x', x(1973)).attr('width', x(2024) - x(1973))
    .attr('fill', (d, i) => colors[i]).attr('opacity', 0.12);

  function updateBlame() {
    const vals = sliders.map(id => parseInt(document.getElementById(id).value));
    const total = vals.reduce((a, b) => a + b, 0);
    // Normalize
    const norm = vals.map(v => v / total * 100);
    sliders.forEach((id, i) => {
      document.getElementById(id + '-val').textContent = Math.round(norm[i]) + '%';
    });

    // Position segments within the gap
    const gapTop = y(lastProd.val);
    const gapBot = y(lastWage.val);
    const gapH = gapBot - gapTop;
    let cumY = gapTop;
    segments.each(function(d, i) {
      const segH = (norm[i] / 100) * gapH;
      d3.select(this).attr('y', cumY).attr('height', segH);
      cumY += segH;
    });
  }

  sliders.forEach((id, idx) => {
    document.getElementById(id).addEventListener('input', function() {
      // Adjust others proportionally so sum stays 100
      const me = parseInt(this.value);
      const others = sliders.filter((_, i) => i !== idx);
      const otherSum = others.reduce((s, oid) => s + parseInt(document.getElementById(oid).value), 0);
      const remaining = 100 - me;
      if (otherSum > 0) {
        others.forEach(oid => {
          const el = document.getElementById(oid);
          el.value = Math.round((parseInt(el.value) / otherSum) * remaining);
        });
      }
      updateBlame();
    });
  });

  updateBlame();
})();
</script>
</body>
</html>
